# 微内核架构，大白话讲就是插件系统

微内核架构主要由两部分组成：Core + plugin，也就是一个内核和多个插件。
- 内核主要负责一些基础功能、核心功能以及插件的管理；
- 插件则是一个独立的功能模块，用来丰富和加强内核的能力。

## Core 和 Plugin 的实现
我们的重点在插件，要想能够在内核中使用插件肯定是要在内核中开个口子的，最基本的问题就是**如何注册**、**如何执行**。
- 插件注册
  - 配置的方式，例如 Webpack 的 plugins 配置
  - 编程的方式，就是系统提供某种注册 api，例如 Vue 的 use 方法
- 插件的管理，也就是插件池，有时我们会用 map，有时我们会用数组，用 map 一般都是要具名的，目的是为了存取方便，尤其是取，就像缓存的感觉；而如果我们只需要单纯的遍历执行插件用数组就可以了。

## 通讯问题
- 可以把内核实例暴露给插件，这样一来我们就能在插件中获取 Core 实例了（也可以叫做上下文），相应的就能够用内核的一些东西了。
- 要是想在内核初始化和执行过程中做一些处理该怎么办呢？我们可以引入**事件机制**，在内核执行过程中抛出一些事件，然后由插件去监听相应的事件，我们可以叫 events，也可以叫 hooks

## 插件的调度
通常来说多个插件有以下几种运行方式：
- 管道式：插件直接顺序执行。例如构建工具 gulp。
- 洋葱式：插件也是顺序执行，但是会经过两次。例如 koa 中间件
- 集散式：插件独立作用，和顺序无关，一般不修改内核，而是扩展各种功能

## 参考文档
- [微内核架构在前端的实现及其应用](https://juejin.cn/post/7163078031601303583)